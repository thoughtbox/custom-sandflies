{
  "name": "process_cron_credential_leak",
  "tags": [
    "attack.id.T1552",
    "attack.tactic.persistence",
    "process"
  ],
  "type": "process",
  "active": true,
  "custom": true,
  "format": "3.0",
  "options": {
    "cron": {
      "command": [
        "://\\S+:\\S+@",
        "(?i)authorization:\\s+bearer\\s+\\S+",
        "(?i)(password|passwd)=\\S+",
        "AWS_(ACCESS|SECRET)_ACCESS_KEY=\\S+",
        "AZURE_CLIENT_SECRET=\\S+",
        "GITHUB_TOKEN=\\S+",
        "MYSQL_PWD=\\S+",
        "RABBITMQ_DEFAULT_PASS=\\S+",
        "SQLCONNECT=.*PWD=\\S+",
        "sshpass.*\\s+-p\\s+\\S+",
        "curl\\s+.*(-u\\s+\\S+:\\S+|-d\\s+\\S+)",
        "-auth",
        "--http(_|-)auth",
        "bcp\\s+.*-P\\S+",
        "isql\\s+.*-P\\s+\\S+",
        "dbping\\s+.*-c\\s+.*PWD=\\S+",
        "mongo\\s+.*-p\\S+",
        "sqlplus\\s+.*\\S+/\\S+@//",
        "(-U|--user)\\s+\\S+:\\S+",
        "ldapsearch\\s+.*-w\\s+\\S+",
        "redis-cli\\s+.*-a\\s+\\S+"
      ],
      "search_paths": [
        "/var/spool/cron",
        "/var/spool/cron/crontabs",
        "/var/spool/cron/tabs",
        "/etc/cron.d"
      ],
      "search_paths_patterns": [
        ".*"
      ],
      "search_paths_individual": [
        "/etc/crontab"
      ],
      "search_paths_patterns_ignore": []
    },
    "engines": [
      "sandfly_engine_cron"
    ],
    "response": {},
    "explanation": "The cronfile '{cron.path}' contains a command ('{cron.command}') that leaks credentials."
  },
  "version": "1.00 Tor Houghton <th@bogus.net>",
  "severity": 3,
  "os_compat": {
    "linux": []
  },
  "date_added": "2023-02-24T19:53:39.573502403Z",
  "description": "Checks crontabs for commands that leak credentials.",
  "max_timeout": 360,
  "max_cpu_load": 1,
  "max_disk_load": 1
}
