{
  "name": "process_command_credential_leak",
  "tags": [
    "attack.id.T1552",
    "attack.tactic.unsecured_credentials",
    "process"
  ],
  "type": "process",
  "active": true,
  "custom": true,
  "format": "3.0",
  "options": {
    "engines": [
      "sandfly_engine_process"
    ],
    "process": {
      "name": [
        ".*"
      ],
      "cmdline": [
        "://\\S+:\\S+@",
        "(?i)authorization:\\s+bearer\\s+\\S+",
        "(?i)(password|passwd)=\\S+",
        "sshpass.*\\s+-p\\s+\\S+",
        "curl\\s+.*(-u\\s+\\S+:\\S+|-d\\s+\\S+)",
        "-auth",
        "--http(_|-)auth",
        "bcp\\s+.*-P\\S+",
        "isql\\s+.*-P\\s+\\S+",
        "dbping\\s+.*-c\\s+.*PWD=\\S+",
        "mongo\\s+.*-p\\S+",
        "sqlplus\\s+.*\\S+/\\S+@//",
        "(-U|--user)\\s+\\S+:\\S+",
        "ldapsearch\\s+.*-w\\s+\\S+",
        "redis-cli\\s+.*-a\\s+\\S+",
        "zip\\s+.*-P\\s+\\S+",
        "rar\\s+.*-hp\\S+",
        "7z\\s+.*-p\\S+"
      ],
      "name_ignore": []
    },
    "response": {
      "process": {
        "kill": false,
        "suspend": false
      }
    },
    "explanation": "The process name '{process.name}' with PID '{process.pid}' appears to be leaking credentials to anyone who is logged in or receives process telemetry, such as third party MSSP's."
  },
  "version": "1.00 Tor Houghton <th@bogus.net>",
  "severity": 3,
  "os_compat": {
    "linux": []
  },
  "date_added": "2023-02-22T17:16:30.188047Z",
  "description": "Searches for processes that leak credentials in the command line arguments.",
  "max_timeout": 360,
  "max_cpu_load": 1,
  "max_disk_load": 1
}
